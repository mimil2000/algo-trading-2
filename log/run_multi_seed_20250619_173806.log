2025-06-19 17:38:06,509 [INFO] Génération de l'exogenous dataset
2025-06-19 17:38:06,511 [INFO] Chargement des données...
2025-06-19 17:38:08,922 [INFO] Analyse de la stationnarité pour différents d...
2025-06-19 17:38:26,111 [DEBUG] d = 0.20 | p-value = 0.0156 => Stationnaire
2025-06-19 17:38:45,819 [DEBUG] d = 0.30 | p-value = 0.0000 => Stationnaire
2025-06-19 17:39:04,706 [DEBUG] d = 0.40 | p-value = 0.0000 => Stationnaire
2025-06-19 17:39:23,803 [DEBUG] d = 0.50 | p-value = 0.0000 => Stationnaire
2025-06-19 17:39:43,387 [DEBUG] d = 0.60 | p-value = 0.0000 => Stationnaire
2025-06-19 17:39:43,394 [INFO] d sélectionné pour la différentiation fractionnaire : 0.2
2025-06-19 17:39:55,269 [INFO] Calcul des indicateurs techniques...
2025-06-19 17:41:07,296 [INFO] Nettoyage des données...
2025-06-19 17:41:07,311 [INFO] Génération des labels triple barrière...
2025-06-19 17:41:08,255 [DEBUG] Window: 4h - Distribution des labels: {0: 0.7587039088463364, 2: 0.12577148282956163, 1: 0.11552460832410191}
2025-06-19 17:41:09,093 [DEBUG] Window: 8h - Distribution des labels: {0: 0.5913514796645039, 2: 0.2089729387561323, 1: 0.19967558157936383}
2025-06-19 17:41:09,971 [DEBUG] Window: 12h - Distribution des labels: {0: 0.4903070106029435, 2: 0.2576357018515588, 1: 0.2520572875454977}
2025-06-19 17:41:10,901 [DEBUG] Window: 24h - Distribution des labels: {0: 0.37648362082608006, 1: 0.31377591391042886, 2: 0.3097404652634911}
2025-06-19 17:41:12,004 [DEBUG] Window: 48h - Distribution des labels: {0: 0.35852191802500394, 1: 0.32311283430922616, 2: 0.3183652476657699}
2025-06-19 17:41:12,004 [INFO] PREDICTION_WINDOW sélectionnée : 24
2025-06-19 17:41:13,249 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['high', 'low', 'close', 'sma_50', 'sma_200', 'ema_20', 'ema_100', 'rsi_dist_oversold', 'rsi_dist_overbought', 'bb_upper', 'bb_lower', 'price_diff_1', 'williams_r', 'kama', 'vwap']
2025-06-19 17:41:15,953 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-19 17:41:15,953 [INFO] Construction des séquences...
2025-06-19 17:44:02,753 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-19 17:44:04,550 [INFO] Démarrage de l'exécution multi-seeds : [42]

2025-06-19 17:44:04,551 [INFO] --- Début du run avec seed 42 ---
2025-06-19 17:44:04,893 [INFO] Entraînement du modèle principal
2025-06-19 17:59:35,584 [DEBUG] [Epoch 1/100] Train Loss: 0.4869 | Val Loss: 0.4820 | Best Val Loss: inf | 
2025-06-19 18:42:17,706 [DEBUG] [Epoch 6/100] Train Loss: 0.3672 | Val Loss: 0.3875 | Best Val Loss: 0.4058 | 
2025-06-19 19:05:22,373 [DEBUG] [Epoch 11/100] Train Loss: 0.2837 | Val Loss: 0.3339 | Best Val Loss: 0.3455 | 
2025-06-19 19:57:58,255 [DEBUG] [Epoch 16/100] Train Loss: 0.2489 | Val Loss: 0.3146 | Best Val Loss: 0.3194 | 
2025-06-19 20:26:28,197 [DEBUG] [Epoch 21/100] Train Loss: 0.2047 | Val Loss: 0.3107 | Best Val Loss: 0.3103 | 
2025-06-19 20:29:42,983 [DEBUG] [Epoch 26/100] Train Loss: 0.2016 | Val Loss: 0.3051 | Best Val Loss: 0.3103 | 
2025-06-19 20:31:09,294 [DEBUG] [Epoch 31/100] Train Loss: 0.1746 | Val Loss: 0.3128 | Best Val Loss: 0.3051 | 
2025-06-19 20:32:17,280 [DEBUG] [Epoch 36/100] Train Loss: 0.1589 | Val Loss: 0.3179 | Best Val Loss: 0.3051 | 
2025-06-19 20:32:17,281 [INFO] Early stopping at epoch 36
2025-06-19 20:32:17,802 [INFO] Évaluation du modèle principal
2025-06-19 20:32:19,292 [INFO] Accuracy: 0.6539, Precision: 0.6528, Recall: 0.6641, F1: 0.6540
2025-06-19 20:32:19,310 [INFO] Génération du dataset méta
2025-06-19 20:32:20,189 [INFO] Prédiction du modèle principal ...
2025-06-19 20:32:25,977 [INFO] Méta labels créés
2025-06-19 20:38:51,156 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-19 20:38:51,374 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-19 20:39:57,386 [INFO] Distribution des classes méta: Classe 0 (erreur): 27.87%, Classe 1 (correct): 72.13%
2025-06-19 20:39:58,953 [INFO] Optimisation du seuil de décision par validation croisée...
2025-06-19 20:44:49,922 [INFO] Fold 1: seuil optimal = 0.6253
2025-06-19 20:47:20,761 [INFO] Fold 2: seuil optimal = 0.5600
2025-06-19 20:49:08,748 [INFO] Fold 3: seuil optimal = 0.5437
2025-06-19 20:49:08,754 [INFO] Seuil optimal médian: 0.5600
2025-06-19 20:49:08,754 [INFO] Entraînement final du méta-modèle...
2025-06-19 20:55:11,868 [INFO] Calibration du modèle...
2025-06-19 20:55:14,066 [INFO] Évaluation sur le set de test :
2025-06-19 20:55:14,084 [INFO]               precision    recall  f1-score   support

           0       0.40      0.22      0.28      1398
           1       0.74      0.87      0.80      3618

    accuracy                           0.69      5016
   macro avg       0.57      0.55      0.54      5016
weighted avg       0.65      0.69      0.66      5016

2025-06-19 20:55:14,106 [INFO] ROC AUC Score : 0.589286
2025-06-19 20:55:14,111 [INFO] Matrice de confusion :
[[ 307 1091]
 [ 458 3160]]
2025-06-19 20:55:14,113 [INFO] Classe 1 - Precision: 0.7434, Recall: 0.8734, F1: 0.8032
2025-06-19 20:55:14,137 [INFO] Top 10 des features importantes:
2025-06-19 20:55:14,138 [INFO]   4753: 0.0021
2025-06-19 20:55:14,138 [INFO]   3559: 0.0020
2025-06-19 20:55:14,138 [INFO]   4105: 0.0019
2025-06-19 20:55:14,139 [INFO]   5374: 0.0014
2025-06-19 20:55:14,139 [INFO]   4132: 0.0012
2025-06-19 20:55:14,139 [INFO]   4234: 0.0011
2025-06-19 20:55:14,139 [INFO]   4369: 0.0010
2025-06-19 20:55:14,140 [INFO]   3586: 0.0009
2025-06-19 20:55:14,140 [INFO]   5395: 0.0009
2025-06-19 20:55:14,140 [INFO]   4396: 0.0009
2025-06-19 20:55:14,180 [INFO] Modèle sauvegardé : C:\CWE_DA\Python\algo-trading-2\meta_model\results\seed_42\xgboost_meta_model_seed_42.joblib
2025-06-19 20:55:15,910 [INFO] Analyse du capture ratio
2025-06-19 20:55:17,208 [INFO] --- Fin du run avec seed 42 ---

2025-06-19 20:55:17,212 [INFO] Moyenne des scores sur tous les seeds :
2025-06-19 20:55:17,213 [INFO] accuracy            0.6539
precision_macro     0.6528
recall_macro        0.6641
f1_macro            0.6540
seed               42.0000
dtype: float64
2025-06-19 20:55:17,215 [INFO] Écart-type des scores :
2025-06-19 20:55:17,216 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-19 20:55:17,220 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
