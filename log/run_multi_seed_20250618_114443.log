2025-06-18 11:44:43,656 [INFO] Génération de l'exogenous dataset
2025-06-18 11:44:43,657 [INFO] Téléchargement des données...
2025-06-18 11:44:44,751 [INFO] Calcul des indicateurs techniques...
2025-06-18 11:45:31,768 [INFO] Lignes avant nettoyage : 29050
2025-06-18 11:45:31,780 [INFO] Lignes après nettoyage : 28339
2025-06-18 11:45:31,781 [INFO] Création des labels...
2025-06-18 11:45:32,280 [INFO] Sélection des colonnes...
2025-06-18 11:45:32,498 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['rsi_dist_oversold', 'rsi_dist_overbought', 'sma_200', 'ema_20', 'ema_100', 'bb_upper', 'bb_lower', 'macd_signal', 'williams_r', 'kama', 'vwap', 'price_diff_1']
2025-06-18 11:45:34,174 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-18 11:47:44,694 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-18 11:47:46,154 [INFO] Démarrage de l'exécution multi-seeds : [42, 2043]
2025-06-18 11:47:46,155 [INFO] --- Début du run avec seed 42 ---
2025-06-18 11:47:46,277 [INFO] Entraînement du modèle principal
2025-06-18 11:48:47,252 [DEBUG] Epoch 1/100 - Train Loss: 0.5495 - Val Loss: 0.5545 - Best Val Loss: inf
2025-06-18 11:49:14,415 [DEBUG] Epoch 2/100 - Train Loss: 0.5362 - Val Loss: 0.5467 - Best Val Loss: 0.5545
2025-06-18 11:49:50,978 [DEBUG] Epoch 3/100 - Train Loss: 0.5191 - Val Loss: 0.5382 - Best Val Loss: 0.5467
2025-06-18 11:50:21,062 [DEBUG] Epoch 4/100 - Train Loss: 0.4967 - Val Loss: 0.5241 - Best Val Loss: 0.5382
2025-06-18 11:50:48,222 [DEBUG] Epoch 5/100 - Train Loss: 0.4727 - Val Loss: 0.5072 - Best Val Loss: 0.5241
2025-06-18 11:51:18,917 [DEBUG] Epoch 6/100 - Train Loss: 0.4414 - Val Loss: 0.4838 - Best Val Loss: 0.5072
2025-06-18 11:51:57,570 [DEBUG] Epoch 7/100 - Train Loss: 0.4132 - Val Loss: 0.4734 - Best Val Loss: 0.4838
2025-06-18 11:52:19,208 [DEBUG] Epoch 8/100 - Train Loss: 0.3852 - Val Loss: 0.4688 - Best Val Loss: 0.4734
2025-06-18 11:52:40,168 [DEBUG] Epoch 9/100 - Train Loss: 0.3654 - Val Loss: 0.4614 - Best Val Loss: 0.4688
2025-06-18 11:53:10,446 [DEBUG] Epoch 10/100 - Train Loss: 0.3462 - Val Loss: 0.4621 - Best Val Loss: 0.4614
2025-06-18 11:53:41,926 [DEBUG] Epoch 11/100 - Train Loss: 0.3372 - Val Loss: 0.4495 - Best Val Loss: 0.4614
2025-06-18 11:54:02,373 [DEBUG] Epoch 12/100 - Train Loss: 0.3276 - Val Loss: 0.4396 - Best Val Loss: 0.4495
2025-06-18 11:54:32,919 [DEBUG] Epoch 13/100 - Train Loss: 0.3080 - Val Loss: 0.4367 - Best Val Loss: 0.4396
2025-06-18 11:55:10,546 [DEBUG] Epoch 14/100 - Train Loss: 0.3047 - Val Loss: 0.4274 - Best Val Loss: 0.4367
2025-06-18 11:55:46,767 [DEBUG] Epoch 15/100 - Train Loss: 0.2886 - Val Loss: 0.4314 - Best Val Loss: 0.4274
2025-06-18 11:56:17,292 [DEBUG] Epoch 16/100 - Train Loss: 0.2723 - Val Loss: 0.4249 - Best Val Loss: 0.4274
2025-06-18 11:56:42,741 [DEBUG] Epoch 17/100 - Train Loss: 0.2731 - Val Loss: 0.4282 - Best Val Loss: 0.4249
2025-06-18 11:57:41,305 [DEBUG] Epoch 18/100 - Train Loss: 0.2577 - Val Loss: 0.4209 - Best Val Loss: 0.4249
2025-06-18 11:58:08,195 [DEBUG] Epoch 19/100 - Train Loss: 0.2573 - Val Loss: 0.4246 - Best Val Loss: 0.4209
2025-06-18 11:58:30,162 [DEBUG] Epoch 20/100 - Train Loss: 0.2467 - Val Loss: 0.4185 - Best Val Loss: 0.4209
2025-06-18 11:58:48,966 [DEBUG] Epoch 21/100 - Train Loss: 0.2367 - Val Loss: 0.4166 - Best Val Loss: 0.4185
2025-06-18 11:59:14,508 [DEBUG] Epoch 22/100 - Train Loss: 0.2266 - Val Loss: 0.4154 - Best Val Loss: 0.4166
2025-06-18 11:59:36,366 [DEBUG] Epoch 23/100 - Train Loss: 0.2225 - Val Loss: 0.4255 - Best Val Loss: 0.4154
2025-06-18 12:00:07,594 [DEBUG] Epoch 24/100 - Train Loss: 0.2384 - Val Loss: 0.4256 - Best Val Loss: 0.4154
2025-06-18 12:00:34,115 [DEBUG] Epoch 25/100 - Train Loss: 0.2278 - Val Loss: 0.4224 - Best Val Loss: 0.4154
2025-06-18 12:00:55,264 [DEBUG] Epoch 26/100 - Train Loss: 0.2190 - Val Loss: 0.4147 - Best Val Loss: 0.4154
2025-06-18 12:01:17,797 [DEBUG] Epoch 27/100 - Train Loss: 0.2113 - Val Loss: 0.4251 - Best Val Loss: 0.4147
2025-06-18 12:01:37,323 [DEBUG] Epoch 28/100 - Train Loss: 0.2172 - Val Loss: 0.4520 - Best Val Loss: 0.4147
2025-06-18 12:01:58,288 [DEBUG] Epoch 29/100 - Train Loss: 0.2106 - Val Loss: 0.4230 - Best Val Loss: 0.4147
2025-06-18 12:02:15,465 [DEBUG] Epoch 30/100 - Train Loss: 0.1948 - Val Loss: 0.4265 - Best Val Loss: 0.4147
2025-06-18 12:02:33,868 [DEBUG] Epoch 31/100 - Train Loss: 0.1893 - Val Loss: 0.4236 - Best Val Loss: 0.4147
2025-06-18 12:02:50,906 [DEBUG] Epoch 32/100 - Train Loss: 0.1873 - Val Loss: 0.4247 - Best Val Loss: 0.4147
2025-06-18 12:03:08,961 [DEBUG] Epoch 33/100 - Train Loss: 0.1892 - Val Loss: 0.4385 - Best Val Loss: 0.4147
2025-06-18 12:03:25,395 [DEBUG] Epoch 34/100 - Train Loss: 0.1859 - Val Loss: 0.4379 - Best Val Loss: 0.4147
2025-06-18 12:03:48,099 [DEBUG] Epoch 35/100 - Train Loss: 0.1739 - Val Loss: 0.4322 - Best Val Loss: 0.4147
2025-06-18 12:04:10,287 [DEBUG] Epoch 36/100 - Train Loss: 0.1765 - Val Loss: 0.4380 - Best Val Loss: 0.4147
2025-06-18 12:04:10,288 [INFO] Early stopping at epoch 36
2025-06-18 12:04:10,792 [INFO] Évaluation du modèle principal
2025-06-18 12:04:11,974 [INFO] Accuracy: 0.4893, Precision: 0.5376, Recall: 0.6159, F1: 0.4941
2025-06-18 12:04:11,991 [INFO] Génération du dataset méta
2025-06-18 12:04:11,991 [INFO] Traitement du seed 42...
2025-06-18 12:04:12,910 [INFO] X_train shape: (19697, 200, 24)
2025-06-18 12:11:35,039 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-18 12:11:35,039 [INFO] Fichier sauvegardé : C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-18 12:11:35,230 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-18 12:12:51,614 [INFO] Entraînement du méta-modèle...
2025-06-18 12:15:30,481 [INFO] Évaluation sur le set de test :
2025-06-18 12:15:30,499 [INFO]               precision    recall  f1-score   support

           0       0.63      0.51      0.56      2552
           1       0.65      0.75      0.70      3076

    accuracy                           0.64      5628
   macro avg       0.64      0.63      0.63      5628
weighted avg       0.64      0.64      0.64      5628

2025-06-18 12:15:30,506 [INFO] ROC AUC Score : 0.631007
2025-06-18 12:15:30,509 [INFO] Confusion Matrix :
[[1305 1247]
 [ 767 2309]]
2025-06-18 12:15:30,526 [INFO] Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-18 12:15:31,401 [INFO] Analyse du capture ratio
2025-06-18 12:15:36,239 [ERROR] Erreur lors du traitement du seed 42: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1348, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "C:\Program Files\Python310\lib\http\client.py", line 1283, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1329, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\Python310\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Program Files\Python310\lib\http\client.py", line 942, in connect
    self.sock = self._create_connection(
  File "C:\Program Files\Python310\lib\socket.py", line 845, in create_connection
    raise err
  File "C:\Program Files\Python310\lib\socket.py", line 833, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 88, in _send_display_message
    urllib_request.urlopen(url, buffer)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 519, in open
    response = self._open(req, data)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "C:\Program Files\Python310\lib\urllib\request.py", line 496, in _call_chain
    result = func(*args)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1351, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [WinError 10061] No connection could be made because the target machine actively refused it>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1348, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "C:\Program Files\Python310\lib\http\client.py", line 1283, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1329, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\Python310\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Program Files\Python310\lib\http\client.py", line 942, in connect
    self.sock = self._create_connection(
  File "C:\Program Files\Python310\lib\socket.py", line 845, in create_connection
    raise err
  File "C:\Program Files\Python310\lib\socket.py", line 833, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 63, in try_empty_proxy
    urllib_request.urlopen(url, buffer)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 519, in open
    response = self._open(req, data)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "C:\Program Files\Python310\lib\urllib\request.py", line 496, in _call_chain
    result = func(*args)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1351, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [WinError 10061] No connection could be made because the target machine actively refused it>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\CWE_DA\Python\algo-trading-2\run_multi_seed.py", line 112, in run_multi_seed
    analyse_capture_ratio(seed=seed)
  File "C:\CWE_DA\Python\algo-trading-2\strategy\utils.py", line 120, in analyse_capture_ratio
    plt.show()
  File "C:\CWE_DA\Python\algo-trading-2\.venv\lib\site-packages\matplotlib\pyplot.py", line 614, in show
    return _get_backend_mod().show(*args, **kwargs)
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_matplotlib_backend\backend_interagg.py", line 43, in __call__
    manager.show(**kwargs)
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_matplotlib_backend\backend_interagg.py", line 142, in show
    self.canvas.show()
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_matplotlib_backend\backend_interagg.py", line 121, in show
    display(DisplayDataObject(plot_index, width, buffer, html_string))
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 45, in display
    _send_display_message({
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 92, in _send_display_message
    try_empty_proxy(buffer)
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 65, in try_empty_proxy
    sys.stderr.write("Error: failed to send plot to %s:%s\n" % (HOST, PORT))
OSError: [Errno 22] Invalid argument
2025-06-18 12:15:36,410 [INFO] --- Début du run avec seed 2043 ---
2025-06-18 12:15:36,463 [INFO] Entraînement du modèle principal
2025-06-18 12:16:12,803 [DEBUG] Epoch 1/100 - Train Loss: 0.5495 - Val Loss: 0.5519 - Best Val Loss: inf
2025-06-18 12:16:28,771 [DEBUG] Epoch 2/100 - Train Loss: 0.5356 - Val Loss: 0.5394 - Best Val Loss: 0.5519
2025-06-18 12:16:44,412 [DEBUG] Epoch 3/100 - Train Loss: 0.5204 - Val Loss: 0.5284 - Best Val Loss: 0.5394
2025-06-18 12:16:59,734 [DEBUG] Epoch 4/100 - Train Loss: 0.5018 - Val Loss: 0.5145 - Best Val Loss: 0.5284
2025-06-18 12:17:15,838 [DEBUG] Epoch 5/100 - Train Loss: 0.4763 - Val Loss: 0.5056 - Best Val Loss: 0.5145
2025-06-18 12:17:31,370 [DEBUG] Epoch 6/100 - Train Loss: 0.4486 - Val Loss: 0.4919 - Best Val Loss: 0.5056
2025-06-18 12:17:47,431 [DEBUG] Epoch 7/100 - Train Loss: 0.4217 - Val Loss: 0.4769 - Best Val Loss: 0.4919
2025-06-18 12:18:03,335 [DEBUG] Epoch 8/100 - Train Loss: 0.3944 - Val Loss: 0.4553 - Best Val Loss: 0.4769
2025-06-18 12:18:19,403 [DEBUG] Epoch 9/100 - Train Loss: 0.3676 - Val Loss: 0.4570 - Best Val Loss: 0.4553
2025-06-18 12:18:35,080 [DEBUG] Epoch 10/100 - Train Loss: 0.3501 - Val Loss: 0.4508 - Best Val Loss: 0.4553
2025-06-18 12:18:51,103 [DEBUG] Epoch 11/100 - Train Loss: 0.3347 - Val Loss: 0.4309 - Best Val Loss: 0.4508
2025-06-18 12:19:06,419 [DEBUG] Epoch 12/100 - Train Loss: 0.3189 - Val Loss: 0.4284 - Best Val Loss: 0.4309
2025-06-18 12:19:22,460 [DEBUG] Epoch 13/100 - Train Loss: 0.3103 - Val Loss: 0.4308 - Best Val Loss: 0.4284
2025-06-18 12:19:38,016 [DEBUG] Epoch 14/100 - Train Loss: 0.2918 - Val Loss: 0.4299 - Best Val Loss: 0.4284
2025-06-18 12:19:54,032 [DEBUG] Epoch 15/100 - Train Loss: 0.2870 - Val Loss: 0.4175 - Best Val Loss: 0.4284
2025-06-18 12:20:09,784 [DEBUG] Epoch 16/100 - Train Loss: 0.2709 - Val Loss: 0.4126 - Best Val Loss: 0.4175
2025-06-18 12:20:25,723 [DEBUG] Epoch 17/100 - Train Loss: 0.2624 - Val Loss: 0.4153 - Best Val Loss: 0.4126
2025-06-18 12:20:40,487 [DEBUG] Epoch 18/100 - Train Loss: 0.2611 - Val Loss: 0.4028 - Best Val Loss: 0.4126
2025-06-18 12:20:57,174 [DEBUG] Epoch 19/100 - Train Loss: 0.2501 - Val Loss: 0.4056 - Best Val Loss: 0.4028
2025-06-18 12:21:12,699 [DEBUG] Epoch 20/100 - Train Loss: 0.2406 - Val Loss: 0.4079 - Best Val Loss: 0.4028
2025-06-18 12:21:29,467 [DEBUG] Epoch 21/100 - Train Loss: 0.2351 - Val Loss: 0.3987 - Best Val Loss: 0.4028
2025-06-18 12:21:45,427 [DEBUG] Epoch 22/100 - Train Loss: 0.2260 - Val Loss: 0.4113 - Best Val Loss: 0.3987
2025-06-18 12:22:00,271 [DEBUG] Epoch 23/100 - Train Loss: 0.2267 - Val Loss: 0.4078 - Best Val Loss: 0.3987
2025-06-18 12:22:15,932 [DEBUG] Epoch 24/100 - Train Loss: 0.2177 - Val Loss: 0.4061 - Best Val Loss: 0.3987
2025-06-18 12:22:31,728 [DEBUG] Epoch 25/100 - Train Loss: 0.2153 - Val Loss: 0.4060 - Best Val Loss: 0.3987
2025-06-18 12:22:47,167 [DEBUG] Epoch 26/100 - Train Loss: 0.2076 - Val Loss: 0.4086 - Best Val Loss: 0.3987
2025-06-18 12:23:02,313 [DEBUG] Epoch 27/100 - Train Loss: 0.2009 - Val Loss: 0.4125 - Best Val Loss: 0.3987
2025-06-18 12:23:18,302 [DEBUG] Epoch 28/100 - Train Loss: 0.2022 - Val Loss: 0.4273 - Best Val Loss: 0.3987
2025-06-18 12:23:33,915 [DEBUG] Epoch 29/100 - Train Loss: 0.2048 - Val Loss: 0.4325 - Best Val Loss: 0.3987
2025-06-18 12:23:49,673 [DEBUG] Epoch 30/100 - Train Loss: 0.2014 - Val Loss: 0.4112 - Best Val Loss: 0.3987
2025-06-18 12:24:05,173 [DEBUG] Epoch 31/100 - Train Loss: 0.1908 - Val Loss: 0.4168 - Best Val Loss: 0.3987
2025-06-18 12:24:05,175 [INFO] Early stopping at epoch 31
2025-06-18 12:24:05,483 [INFO] Évaluation du modèle principal
2025-06-18 12:24:06,639 [INFO] Accuracy: 0.5012, Precision: 0.5410, Recall: 0.6122, F1: 0.5056
2025-06-18 12:24:06,659 [INFO] Génération du dataset méta
2025-06-18 12:24:06,659 [INFO] Traitement du seed 2043...
2025-06-18 12:24:07,532 [INFO] X_train shape: (19697, 200, 24)
2025-06-18 12:30:41,719 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_2043.csv
2025-06-18 12:30:41,721 [INFO] Fichier sauvegardé : C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_2043.csv
2025-06-18 12:30:41,891 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-18 12:31:48,712 [INFO] Entraînement du méta-modèle...
2025-06-18 12:33:16,803 [INFO] Évaluation sur le set de test :
2025-06-18 12:33:16,824 [INFO]               precision    recall  f1-score   support

           0       0.65      0.48      0.55      2518
           1       0.65      0.79      0.71      3110

    accuracy                           0.65      5628
   macro avg       0.65      0.63      0.63      5628
weighted avg       0.65      0.65      0.64      5628

2025-06-18 12:33:16,831 [INFO] ROC AUC Score : 0.634643
2025-06-18 12:33:16,834 [INFO] Confusion Matrix :
[[1210 1308]
 [ 657 2453]]
2025-06-18 12:33:16,854 [INFO] Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-18 12:33:17,672 [INFO] Analyse du capture ratio
2025-06-18 12:33:22,178 [ERROR] Erreur lors du traitement du seed 2043: [Errno 22] Invalid argument
Traceback (most recent call last):
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1348, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "C:\Program Files\Python310\lib\http\client.py", line 1283, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1329, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\Python310\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Program Files\Python310\lib\http\client.py", line 942, in connect
    self.sock = self._create_connection(
  File "C:\Program Files\Python310\lib\socket.py", line 845, in create_connection
    raise err
  File "C:\Program Files\Python310\lib\socket.py", line 833, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 88, in _send_display_message
    urllib_request.urlopen(url, buffer)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 519, in open
    response = self._open(req, data)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "C:\Program Files\Python310\lib\urllib\request.py", line 496, in _call_chain
    result = func(*args)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1351, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [WinError 10061] No connection could be made because the target machine actively refused it>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1348, in do_open
    h.request(req.get_method(), req.selector, req.data, headers,
  File "C:\Program Files\Python310\lib\http\client.py", line 1283, in request
    self._send_request(method, url, body, headers, encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1329, in _send_request
    self.endheaders(body, encode_chunked=encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1278, in endheaders
    self._send_output(message_body, encode_chunked=encode_chunked)
  File "C:\Program Files\Python310\lib\http\client.py", line 1038, in _send_output
    self.send(msg)
  File "C:\Program Files\Python310\lib\http\client.py", line 976, in send
    self.connect()
  File "C:\Program Files\Python310\lib\http\client.py", line 942, in connect
    self.sock = self._create_connection(
  File "C:\Program Files\Python310\lib\socket.py", line 845, in create_connection
    raise err
  File "C:\Program Files\Python310\lib\socket.py", line 833, in create_connection
    sock.connect(sa)
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 63, in try_empty_proxy
    urllib_request.urlopen(url, buffer)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 519, in open
    response = self._open(req, data)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "C:\Program Files\Python310\lib\urllib\request.py", line 496, in _call_chain
    result = func(*args)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
  File "C:\Program Files\Python310\lib\urllib\request.py", line 1351, in do_open
    raise URLError(err)
urllib.error.URLError: <urlopen error [WinError 10061] No connection could be made because the target machine actively refused it>

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\CWE_DA\Python\algo-trading-2\run_multi_seed.py", line 112, in run_multi_seed
    analyse_capture_ratio(seed=seed)
  File "C:\CWE_DA\Python\algo-trading-2\strategy\utils.py", line 120, in analyse_capture_ratio
    plt.show()
  File "C:\CWE_DA\Python\algo-trading-2\.venv\lib\site-packages\matplotlib\pyplot.py", line 614, in show
    return _get_backend_mod().show(*args, **kwargs)
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_matplotlib_backend\backend_interagg.py", line 43, in __call__
    manager.show(**kwargs)
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_matplotlib_backend\backend_interagg.py", line 142, in show
    self.canvas.show()
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_matplotlib_backend\backend_interagg.py", line 121, in show
    display(DisplayDataObject(plot_index, width, buffer, html_string))
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 45, in display
    _send_display_message({
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 92, in _send_display_message
    try_empty_proxy(buffer)
  File "C:\Program Files (x86)\JetBrains\PyCharm 2024.3.1.1\plugins\python-ce\helpers\pycharm_display\datalore\display\display_.py", line 65, in try_empty_proxy
    sys.stderr.write("Error: failed to send plot to %s:%s\n" % (HOST, PORT))
OSError: [Errno 22] Invalid argument
2025-06-18 12:33:22,182 [INFO] Moyenne des scores sur tous les seeds :
2025-06-18 12:33:22,184 [INFO] accuracy              0.4953
precision_macro       0.5393
recall_macro          0.6140
f1_macro              0.4998
seed               1042.5000
dtype: float64
2025-06-18 12:33:22,186 [INFO] Écart-type des scores :
2025-06-18 12:33:22,188 [INFO] accuracy              0.0084
precision_macro       0.0024
recall_macro          0.0026
f1_macro              0.0082
seed               1414.9207
dtype: float64
2025-06-18 12:33:22,192 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
