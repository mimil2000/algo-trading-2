2025-06-19 11:13:53,054 [INFO] Génération de l'exogenous dataset
2025-06-19 11:13:53,056 [INFO] Chargement des données...
2025-06-19 11:13:54,555 [INFO] Application de la différentiation fractionnaire...
2025-06-19 11:14:02,847 [INFO] Calcul des indicateurs techniques...
2025-06-19 11:14:03,477 [INFO] Génération des labels triple barriere...
2025-06-19 11:14:04,247 [DEBUG] Window: 4h - Distribution: {0: 0.7540179887938662, 2: 0.12724859923326454, 1: 0.11873341197286937}
2025-06-19 11:14:04,911 [DEBUG] Window: 8h - Distribution: {0: 0.585446770864052, 2: 0.21029932173400176, 1: 0.20425390740194632}
2025-06-19 11:14:05,661 [DEBUG] Window: 12h - Distribution: {0: 0.48462842819227364, 2: 0.2592524329106458, 1: 0.2561191388970805}
2025-06-19 11:14:06,380 [DEBUG] Window: 24h - Distribution: {0: 0.3741153052196992, 1: 0.3161309348274845, 2: 0.3097537599528163}
2025-06-19 11:14:07,243 [DEBUG] Window: 48h - Distribution: {0: 0.3573429666764966, 1: 0.32483043350044233, 2: 0.31782659982306105}
2025-06-19 11:14:07,243 [INFO] PREDICTION_WINDOW sélectionnée : 24
2025-06-19 11:14:07,929 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['sma_50', 'ema_20', 'bb_upper', 'bb_lower']
2025-06-19 11:14:08,408 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-19 11:14:30,168 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-19 11:14:30,250 [INFO] Démarrage de l'exécution multi-seeds : [42]
2025-06-19 11:14:30,251 [INFO] --- Début du run avec seed 42 ---
2025-06-19 11:14:30,366 [INFO] Entraînement du modèle principal
2025-06-19 11:16:09,882 [DEBUG] Epoch 1/100 - Train Loss: 0.4897 - Val Loss: 0.4901 - Best Val Loss: inf
2025-06-19 11:17:23,224 [DEBUG] Epoch 2/100 - Train Loss: 0.4887 - Val Loss: 0.4896 - Best Val Loss: 0.4901
2025-06-19 11:18:33,229 [DEBUG] Epoch 3/100 - Train Loss: 0.4882 - Val Loss: 0.4893 - Best Val Loss: 0.4896
2025-06-19 11:19:08,658 [DEBUG] Epoch 4/100 - Train Loss: 0.4879 - Val Loss: 0.4891 - Best Val Loss: 0.4893
2025-06-19 11:19:28,481 [DEBUG] Epoch 5/100 - Train Loss: 0.4874 - Val Loss: 0.4889 - Best Val Loss: 0.4891
2025-06-19 11:19:40,766 [DEBUG] Epoch 6/100 - Train Loss: 0.4866 - Val Loss: 0.4889 - Best Val Loss: 0.4889
2025-06-19 11:19:52,316 [DEBUG] Epoch 7/100 - Train Loss: 0.4856 - Val Loss: 0.4886 - Best Val Loss: 0.4889
2025-06-19 11:20:07,829 [DEBUG] Epoch 8/100 - Train Loss: 0.4838 - Val Loss: 0.4882 - Best Val Loss: 0.4886
2025-06-19 11:20:19,853 [DEBUG] Epoch 9/100 - Train Loss: 0.4820 - Val Loss: 0.4901 - Best Val Loss: 0.4882
2025-06-19 11:20:32,194 [DEBUG] Epoch 10/100 - Train Loss: 0.4796 - Val Loss: 0.4863 - Best Val Loss: 0.4882
2025-06-19 11:20:45,938 [DEBUG] Epoch 11/100 - Train Loss: 0.4761 - Val Loss: 0.4850 - Best Val Loss: 0.4863
2025-06-19 11:20:58,076 [DEBUG] Epoch 12/100 - Train Loss: 0.4731 - Val Loss: 0.4831 - Best Val Loss: 0.4850
2025-06-19 11:21:10,725 [DEBUG] Epoch 13/100 - Train Loss: 0.4765 - Val Loss: 0.4867 - Best Val Loss: 0.4831
2025-06-19 11:21:22,383 [DEBUG] Epoch 14/100 - Train Loss: 0.4799 - Val Loss: 0.4855 - Best Val Loss: 0.4831
2025-06-19 11:21:34,442 [DEBUG] Epoch 15/100 - Train Loss: 0.4801 - Val Loss: 0.4869 - Best Val Loss: 0.4831
2025-06-19 11:21:46,906 [DEBUG] Epoch 16/100 - Train Loss: 0.4742 - Val Loss: 0.4855 - Best Val Loss: 0.4831
2025-06-19 11:21:58,884 [DEBUG] Epoch 17/100 - Train Loss: 0.4760 - Val Loss: 0.4874 - Best Val Loss: 0.4831
2025-06-19 11:22:10,821 [DEBUG] Epoch 18/100 - Train Loss: 0.4870 - Val Loss: 0.4897 - Best Val Loss: 0.4831
2025-06-19 11:22:23,017 [DEBUG] Epoch 19/100 - Train Loss: 0.4886 - Val Loss: 0.4879 - Best Val Loss: 0.4831
2025-06-19 11:22:35,104 [DEBUG] Epoch 20/100 - Train Loss: 0.4868 - Val Loss: 0.4864 - Best Val Loss: 0.4831
2025-06-19 11:22:47,093 [DEBUG] Epoch 21/100 - Train Loss: 0.4857 - Val Loss: 0.4859 - Best Val Loss: 0.4831
2025-06-19 11:22:58,726 [DEBUG] Epoch 22/100 - Train Loss: 0.4879 - Val Loss: 0.4895 - Best Val Loss: 0.4831
2025-06-19 11:22:58,727 [INFO] Early stopping at epoch 22
2025-06-19 11:22:58,787 [INFO] Évaluation du modèle principal
2025-06-19 11:22:59,597 [INFO] Accuracy: 0.3847, Precision: 0.4012, Recall: 0.4002, F1: 0.3732
2025-06-19 11:22:59,601 [INFO] Génération du dataset méta
2025-06-19 11:22:59,861 [INFO] Prédiction du modèle principal ...
2025-06-19 11:23:04,555 [INFO] Méta labels créés
2025-06-19 11:24:17,364 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-19 11:24:17,400 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-19 11:24:28,456 [INFO] Entraînement du méta-modèle...
2025-06-19 11:24:50,882 [INFO] Évaluation sur le set de test :
2025-06-19 11:24:50,904 [INFO]               precision    recall  f1-score   support

           0       0.64      0.89      0.75      3227
           1       0.62      0.27      0.37      2159

    accuracy                           0.64      5386
   macro avg       0.63      0.58      0.56      5386
weighted avg       0.63      0.64      0.60      5386

2025-06-19 11:24:50,910 [INFO] ROC AUC Score : 0.578309
2025-06-19 11:24:50,913 [INFO] Confusion Matrix :
[[2864  363]
 [1578  581]]
2025-06-19 11:24:50,923 [INFO] Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-19 11:24:51,066 [INFO] Analyse du capture ratio
2025-06-19 11:24:52,440 [INFO] --- Fin du run avec seed 42 ---

2025-06-19 11:24:52,442 [INFO] Moyenne des scores sur tous les seeds :
2025-06-19 11:24:52,443 [INFO] accuracy            0.3847
precision_macro     0.4012
recall_macro        0.4002
f1_macro            0.3732
seed               42.0000
dtype: float64
2025-06-19 11:24:52,446 [INFO] Écart-type des scores :
2025-06-19 11:24:52,448 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-19 11:24:52,452 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
