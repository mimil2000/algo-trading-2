2025-06-19 13:05:22,832 [INFO] Génération de l'exogenous dataset
2025-06-19 13:05:22,833 [INFO] Chargement des données...
2025-06-19 13:05:24,196 [INFO] Analyse de la stationnarité pour différents d...
2025-06-19 13:05:32,882 [INFO] d = 0.20 | p-value = 0.0156 => Stationnaire
2025-06-19 13:05:42,280 [INFO] d = 0.30 | p-value = 0.0000 => Stationnaire
2025-06-19 13:05:52,009 [INFO] d = 0.40 | p-value = 0.0000 => Stationnaire
2025-06-19 13:06:04,555 [INFO] d = 0.50 | p-value = 0.0000 => Stationnaire
2025-06-19 13:06:13,802 [INFO] d = 0.60 | p-value = 0.0000 => Stationnaire
2025-06-19 13:06:13,804 [INFO] d sélectionné pour la différentiation fractionnaire : 0.2
2025-06-19 13:06:19,909 [INFO] Calcul des indicateurs techniques...
2025-06-19 13:07:06,772 [INFO] Nettoyage des données...
2025-06-19 13:07:06,782 [INFO] Génération des labels triple barrière...
2025-06-19 13:07:07,208 [DEBUG] Window: 4h - Distribution des labels: {0: 0.7587039088463364, 2: 0.12577148282956163, 1: 0.11552460832410191}
2025-06-19 13:07:07,745 [DEBUG] Window: 8h - Distribution des labels: {0: 0.5913514796645039, 2: 0.2089729387561323, 1: 0.19967558157936383}
2025-06-19 13:07:08,264 [DEBUG] Window: 12h - Distribution des labels: {0: 0.4903070106029435, 2: 0.2576357018515588, 1: 0.2520572875454977}
2025-06-19 13:07:08,875 [DEBUG] Window: 24h - Distribution des labels: {0: 0.37648362082608006, 1: 0.31377591391042886, 2: 0.3097404652634911}
2025-06-19 13:07:09,619 [DEBUG] Window: 48h - Distribution des labels: {0: 0.35852191802500394, 1: 0.32311283430922616, 2: 0.3183652476657699}
2025-06-19 13:07:09,619 [INFO] PREDICTION_WINDOW sélectionnée : 24
2025-06-19 13:07:10,445 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['high', 'low', 'close', 'sma_50', 'sma_200', 'ema_20', 'ema_100', 'rsi_dist_oversold', 'rsi_dist_overbought', 'bb_upper', 'bb_lower', 'macd_signal', 'price_diff_1', 'williams_r', 'kama', 'vwap']
2025-06-19 13:07:12,456 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-19 13:07:12,456 [INFO] Construction des séquences...
2025-06-19 13:09:19,612 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-19 13:09:20,641 [INFO] Démarrage de l'exécution multi-seeds : [42]

2025-06-19 13:09:20,641 [INFO] --- Début du run avec seed 42 ---
2025-06-19 13:09:20,759 [INFO] Entraînement du modèle principal
2025-06-19 13:10:27,345 [DEBUG] Epoch 1/100 - Train Loss: 0.4869 - Val Loss: 0.4820 - Best Val Loss: inf
2025-06-19 13:10:47,621 [DEBUG] Epoch 2/100 - Train Loss: 0.4757 - Val Loss: 0.4690 - Best Val Loss: 0.4820
2025-06-19 13:11:07,442 [DEBUG] Epoch 3/100 - Train Loss: 0.4569 - Val Loss: 0.4504 - Best Val Loss: 0.4690
2025-06-19 13:11:22,500 [DEBUG] Epoch 4/100 - Train Loss: 0.4302 - Val Loss: 0.4257 - Best Val Loss: 0.4504
2025-06-19 13:11:38,046 [DEBUG] Epoch 5/100 - Train Loss: 0.3978 - Val Loss: 0.4058 - Best Val Loss: 0.4257
2025-06-19 13:11:55,664 [DEBUG] Epoch 6/100 - Train Loss: 0.3672 - Val Loss: 0.3875 - Best Val Loss: 0.4058
2025-06-19 13:12:08,547 [DEBUG] Epoch 7/100 - Train Loss: 0.3426 - Val Loss: 0.3615 - Best Val Loss: 0.3875
2025-06-19 13:12:20,887 [DEBUG] Epoch 8/100 - Train Loss: 0.3171 - Val Loss: 0.3455 - Best Val Loss: 0.3615
2025-06-19 13:12:33,533 [DEBUG] Epoch 9/100 - Train Loss: 0.3349 - Val Loss: 0.3855 - Best Val Loss: 0.3455
2025-06-19 13:12:45,617 [DEBUG] Epoch 10/100 - Train Loss: 0.3143 - Val Loss: 0.3510 - Best Val Loss: 0.3455
2025-06-19 13:12:58,216 [DEBUG] Epoch 11/100 - Train Loss: 0.2837 - Val Loss: 0.3339 - Best Val Loss: 0.3455
2025-06-19 13:13:11,405 [DEBUG] Epoch 12/100 - Train Loss: 0.2710 - Val Loss: 0.3292 - Best Val Loss: 0.3339
2025-06-19 13:13:24,245 [DEBUG] Epoch 13/100 - Train Loss: 0.2590 - Val Loss: 0.3194 - Best Val Loss: 0.3292
2025-06-19 13:13:39,180 [DEBUG] Epoch 14/100 - Train Loss: 0.2479 - Val Loss: 0.3218 - Best Val Loss: 0.3194
2025-06-19 13:13:52,636 [DEBUG] Epoch 15/100 - Train Loss: 0.2469 - Val Loss: 0.3803 - Best Val Loss: 0.3194
2025-06-19 13:14:08,651 [DEBUG] Epoch 16/100 - Train Loss: 0.2489 - Val Loss: 0.3146 - Best Val Loss: 0.3194
2025-06-19 13:14:23,951 [DEBUG] Epoch 17/100 - Train Loss: 0.2267 - Val Loss: 0.3197 - Best Val Loss: 0.3146
2025-06-19 13:14:38,105 [DEBUG] Epoch 18/100 - Train Loss: 0.2226 - Val Loss: 0.3197 - Best Val Loss: 0.3146
2025-06-19 13:14:51,960 [DEBUG] Epoch 19/100 - Train Loss: 0.2157 - Val Loss: 0.3108 - Best Val Loss: 0.3146
2025-06-19 13:15:06,889 [DEBUG] Epoch 20/100 - Train Loss: 0.2096 - Val Loss: 0.3103 - Best Val Loss: 0.3108
2025-06-19 13:15:20,477 [DEBUG] Epoch 21/100 - Train Loss: 0.2047 - Val Loss: 0.3107 - Best Val Loss: 0.3103
2025-06-19 13:15:34,100 [DEBUG] Epoch 22/100 - Train Loss: 0.2058 - Val Loss: 0.3121 - Best Val Loss: 0.3103
2025-06-19 13:15:47,556 [DEBUG] Epoch 23/100 - Train Loss: 0.1961 - Val Loss: 0.3131 - Best Val Loss: 0.3103
2025-06-19 13:16:02,343 [DEBUG] Epoch 24/100 - Train Loss: 0.1950 - Val Loss: 0.3131 - Best Val Loss: 0.3103
2025-06-19 13:16:17,083 [DEBUG] Epoch 25/100 - Train Loss: 0.2382 - Val Loss: 0.3343 - Best Val Loss: 0.3103
2025-06-19 13:16:30,684 [DEBUG] Epoch 26/100 - Train Loss: 0.2016 - Val Loss: 0.3051 - Best Val Loss: 0.3103
2025-06-19 13:16:44,910 [DEBUG] Epoch 27/100 - Train Loss: 0.1865 - Val Loss: 0.3057 - Best Val Loss: 0.3051
2025-06-19 13:17:00,251 [DEBUG] Epoch 28/100 - Train Loss: 0.1812 - Val Loss: 0.3106 - Best Val Loss: 0.3051
2025-06-19 13:17:14,166 [DEBUG] Epoch 29/100 - Train Loss: 0.1783 - Val Loss: 0.3109 - Best Val Loss: 0.3051
2025-06-19 13:17:27,852 [DEBUG] Epoch 30/100 - Train Loss: 0.1824 - Val Loss: 0.3231 - Best Val Loss: 0.3051
2025-06-19 13:17:41,592 [DEBUG] Epoch 31/100 - Train Loss: 0.1746 - Val Loss: 0.3128 - Best Val Loss: 0.3051
2025-06-19 13:17:56,883 [DEBUG] Epoch 32/100 - Train Loss: 0.1690 - Val Loss: 0.3183 - Best Val Loss: 0.3051
2025-06-19 13:18:10,588 [DEBUG] Epoch 33/100 - Train Loss: 0.1713 - Val Loss: 0.3285 - Best Val Loss: 0.3051
2025-06-19 13:18:24,936 [DEBUG] Epoch 34/100 - Train Loss: 0.1941 - Val Loss: 0.3275 - Best Val Loss: 0.3051
2025-06-19 13:18:38,702 [DEBUG] Epoch 35/100 - Train Loss: 0.1745 - Val Loss: 0.3165 - Best Val Loss: 0.3051
2025-06-19 13:18:52,063 [DEBUG] Epoch 36/100 - Train Loss: 0.1589 - Val Loss: 0.3179 - Best Val Loss: 0.3051
2025-06-19 13:18:52,065 [INFO] Early stopping at epoch 36
2025-06-19 13:18:52,375 [INFO] Évaluation du modèle principal
2025-06-19 13:18:53,629 [INFO] Accuracy: 0.6539, Precision: 0.6528, Recall: 0.6641, F1: 0.6540
2025-06-19 13:18:53,645 [INFO] Génération du dataset méta
2025-06-19 13:18:54,669 [INFO] Prédiction du modèle principal ...
2025-06-19 13:19:01,427 [INFO] Méta labels créés
2025-06-19 13:26:57,927 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-19 13:26:58,134 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-19 13:28:19,229 [INFO] Entraînement du méta-modèle...
2025-06-19 13:30:20,567 [INFO] Évaluation sur le set de test :
2025-06-19 13:30:20,586 [INFO]               precision    recall  f1-score   support

           0       0.47      0.06      0.11      1398
           1       0.73      0.97      0.83      3618

    accuracy                           0.72      5016
   macro avg       0.60      0.52      0.47      5016
weighted avg       0.66      0.72      0.63      5016

2025-06-19 13:30:20,590 [INFO] ROC AUC Score : 0.516971
2025-06-19 13:30:20,594 [INFO] Confusion Matrix :
[[  83 1315]
 [  92 3526]]
2025-06-19 13:30:20,618 [INFO] Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-19 13:30:21,530 [INFO] Analyse du capture ratio
2025-06-19 13:30:23,110 [INFO] --- Fin du run avec seed 42 ---

2025-06-19 13:30:23,110 [INFO] Moyenne des scores sur tous les seeds :
2025-06-19 13:30:23,112 [INFO] accuracy            0.6539
precision_macro     0.6528
recall_macro        0.6641
f1_macro            0.6540
seed               42.0000
dtype: float64
2025-06-19 13:30:23,114 [INFO] Écart-type des scores :
2025-06-19 13:30:23,116 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-19 13:30:23,120 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
