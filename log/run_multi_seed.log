2025-06-17 13:21:25,775 [INFO] Génération de l'exogenous dataset
2025-06-17 13:21:25,776 [INFO] Téléchargement des données...
2025-06-17 13:21:26,762 [INFO] Calcul des indicateurs techniques...
2025-06-17 13:22:03,858 [INFO] Lignes avant nettoyage : 29050
2025-06-17 13:22:03,868 [INFO] Lignes après nettoyage : 28339
2025-06-17 13:22:03,869 [INFO] Création des labels...
2025-06-17 13:22:04,265 [INFO] Sélection des colonnes...
2025-06-17 13:22:04,443 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['rsi_dist_oversold', 'rsi_dist_overbought', 'sma_200', 'ema_20', 'ema_100', 'bb_upper', 'bb_lower', 'macd_signal', 'williams_r', 'kama', 'vwap', 'price_diff_1']
2025-06-17 13:22:05,940 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-17 13:22:25,789 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-17 13:22:25,832 [INFO] Démarrage de l'exécution multi-seeds : [42]
2025-06-17 13:22:25,833 [INFO] --- Début du run avec seed 42 ---
2025-06-17 13:22:25,835 [INFO] Entraînement du modèle principal
2025-06-17 13:23:27,549 [INFO] Évaluation du modèle principal
2025-06-17 13:23:27,882 [INFO] Seed 42 — Accuracy: 0.5051, Precision: 0.5406, Recall: 0.6045, F1: 0.5056
2025-06-17 13:23:27,883 [INFO] Génération du dataset méta
2025-06-17 13:23:27,884 [INFO]  Traitement du seed 42...
2025-06-17 13:23:28,070 [INFO] Seed 42 - X_train shape: (19823, 20, 24)
2025-06-17 13:24:07,178 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 13:24:07,179 [INFO] Fichier sauvegardé : C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 13:24:07,199 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-17 13:24:12,557 [INFO] [•] Entraînement du méta-modèle...
2025-06-17 13:24:24,792 [INFO] 
Évaluation sur le set de test :
2025-06-17 13:24:24,811 [INFO]               precision    recall  f1-score   support

           0       0.58      0.41      0.48      2502
           1       0.62      0.76      0.68      3162

    accuracy                           0.61      5664
   macro avg       0.60      0.59      0.58      5664
weighted avg       0.60      0.61      0.59      5664

2025-06-17 13:24:24,818 [INFO] ROC AUC Score : 0.587040
2025-06-17 13:24:24,822 [INFO] Confusion Matrix :
[[1029 1473]
 [ 750 2412]]
2025-06-17 13:24:24,838 [INFO] 
 Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-17 13:24:24,878 [INFO] Analyse du capture ratio
2025-06-17 13:24:24,976 [ERROR] Erreur lors du traitement du seed 42: name 'plt' is not defined
Traceback (most recent call last):
  File "C:\CWE_DA\Python\algo-trading-2\run_multi_seed.py", line 101, in run_multi_seed
    analyse_capture_ratio(seed=seed)
  File "C:\CWE_DA\Python\algo-trading-2\strategy\utils.py", line 102, in analyse_capture_ratio
    fig, ax1 = plt.subplots(figsize=(12, 6))
NameError: name 'plt' is not defined
2025-06-17 13:24:25,005 [INFO] Moyenne des scores sur tous les seeds :
2025-06-17 13:24:25,006 [INFO] accuracy            0.5051
precision_macro     0.5406
recall_macro        0.6045
f1_macro            0.5056
seed               42.0000
dtype: float64
2025-06-17 13:24:25,009 [INFO] Écart-type des scores :
2025-06-17 13:24:25,011 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-17 13:24:25,014 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
2025-06-17 13:25:50,994 [INFO] Génération de l'exogenous dataset
2025-06-17 13:25:50,995 [INFO] Téléchargement des données...
2025-06-17 13:25:52,287 [INFO] Calcul des indicateurs techniques...
2025-06-17 13:26:36,023 [INFO] Lignes avant nettoyage : 29050
2025-06-17 13:26:36,033 [INFO] Lignes après nettoyage : 28339
2025-06-17 13:26:36,033 [INFO] Création des labels...
2025-06-17 13:26:36,457 [INFO] Sélection des colonnes...
2025-06-17 13:26:36,659 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['rsi_dist_oversold', 'rsi_dist_overbought', 'sma_200', 'ema_20', 'ema_100', 'bb_upper', 'bb_lower', 'macd_signal', 'williams_r', 'kama', 'vwap', 'price_diff_1']
2025-06-17 13:26:38,188 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-17 13:27:01,829 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-17 13:27:01,873 [INFO] Démarrage de l'exécution multi-seeds : [42]
2025-06-17 13:27:01,874 [INFO] --- Début du run avec seed 42 ---
2025-06-17 13:27:01,970 [INFO] Entraînement du modèle principal
2025-06-17 13:28:07,450 [INFO] Évaluation du modèle principal
2025-06-17 13:28:07,788 [INFO] Seed 42 — Accuracy: 0.5051, Precision: 0.5406, Recall: 0.6045, F1: 0.5056
2025-06-17 13:28:07,791 [INFO] Génération du dataset méta
2025-06-17 13:28:07,791 [INFO]  Traitement du seed 42...
2025-06-17 13:28:07,963 [INFO] Seed 42 - X_train shape: (19823, 20, 24)
2025-06-17 13:28:45,774 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 13:28:45,774 [INFO] Fichier sauvegardé : C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 13:28:45,793 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-17 13:28:51,555 [INFO] [•] Entraînement du méta-modèle...
2025-06-17 13:29:01,823 [INFO] 
Évaluation sur le set de test :
2025-06-17 13:29:01,843 [INFO]               precision    recall  f1-score   support

           0       0.58      0.41      0.48      2502
           1       0.62      0.76      0.68      3162

    accuracy                           0.61      5664
   macro avg       0.60      0.59      0.58      5664
weighted avg       0.60      0.61      0.59      5664

2025-06-17 13:29:01,848 [INFO] ROC AUC Score : 0.587040
2025-06-17 13:29:01,852 [INFO] Confusion Matrix :
[[1029 1473]
 [ 750 2412]]
2025-06-17 13:29:01,862 [INFO] 
 Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-17 13:29:01,904 [INFO] Analyse du capture ratio
2025-06-17 13:29:03,704 [INFO] --- Fin du run avec seed 42 ---

2025-06-17 13:29:03,706 [INFO] Moyenne des scores sur tous les seeds :
2025-06-17 13:29:03,707 [INFO] accuracy            0.5051
precision_macro     0.5406
recall_macro        0.6045
f1_macro            0.5056
seed               42.0000
dtype: float64
2025-06-17 13:29:03,710 [INFO] Écart-type des scores :
2025-06-17 13:29:03,711 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-17 13:29:03,715 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
2025-06-17 13:39:47,801 [INFO] Génération de l'exogenous dataset
2025-06-17 13:39:47,802 [INFO] Téléchargement des données...
2025-06-17 13:39:48,872 [INFO] Calcul des indicateurs techniques...
2025-06-17 13:41:56,140 [INFO] Génération de l'exogenous dataset
2025-06-17 13:41:56,141 [INFO] Téléchargement des données...
2025-06-17 13:41:57,064 [INFO] Calcul des indicateurs techniques...
2025-06-17 13:42:36,606 [INFO] Lignes avant nettoyage : 29050
2025-06-17 13:42:36,618 [INFO] Lignes après nettoyage : 28339
2025-06-17 13:42:36,618 [INFO] Création des labels...
2025-06-17 13:42:37,279 [INFO] Sélection des colonnes...
2025-06-17 13:42:37,522 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['rsi_dist_oversold', 'rsi_dist_overbought', 'sma_200', 'ema_20', 'ema_100', 'bb_upper', 'bb_lower', 'macd_signal', 'williams_r', 'kama', 'vwap', 'price_diff_1']
2025-06-17 13:42:39,293 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-17 13:43:05,652 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-17 13:43:05,699 [INFO] Démarrage de l'exécution multi-seeds : [42]
2025-06-17 13:43:05,700 [INFO] --- Début du run avec seed 42 ---
2025-06-17 13:43:05,792 [INFO] Entraînement du modèle principal
2025-06-17 13:44:20,983 [INFO] Évaluation du modèle principal
2025-06-17 13:44:21,553 [INFO] Seed 42 — Accuracy: 0.5051, Precision: 0.5406, Recall: 0.6045, F1: 0.5056
2025-06-17 13:44:21,555 [INFO] Génération du dataset méta
2025-06-17 13:44:21,556 [INFO]  Traitement du seed 42...
2025-06-17 13:44:21,743 [INFO] Seed 42 - X_train shape: (19823, 20, 24)
2025-06-17 13:45:04,811 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 13:45:04,812 [INFO] Fichier sauvegardé : C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 13:45:04,830 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-17 13:45:10,459 [INFO] Entraînement du méta-modèle...
2025-06-17 13:45:21,127 [INFO] 
Évaluation sur le set de test :
2025-06-17 13:45:21,149 [INFO]               precision    recall  f1-score   support

           0       0.58      0.41      0.48      2502
           1       0.62      0.76      0.68      3162

    accuracy                           0.61      5664
   macro avg       0.60      0.59      0.58      5664
weighted avg       0.60      0.61      0.59      5664

2025-06-17 13:45:21,154 [INFO] ROC AUC Score : 0.587040
2025-06-17 13:45:21,158 [INFO] Confusion Matrix :
[[1029 1473]
 [ 750 2412]]
2025-06-17 13:45:21,168 [INFO] 
 Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-17 13:45:21,223 [INFO] Analyse du capture ratio
2025-06-17 13:45:22,118 [INFO] --- Fin du run avec seed 42 ---

2025-06-17 13:45:22,120 [INFO] Moyenne des scores sur tous les seeds :
2025-06-17 13:45:22,121 [INFO] accuracy            0.5051
precision_macro     0.5406
recall_macro        0.6045
f1_macro            0.5056
seed               42.0000
dtype: float64
2025-06-17 13:45:22,123 [INFO] Écart-type des scores :
2025-06-17 13:45:22,125 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-17 13:45:22,129 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
2025-06-17 13:47:53,896 [INFO] Génération de l'exogenous dataset
2025-06-17 13:47:53,898 [INFO] Téléchargement des données...
2025-06-17 13:47:55,001 [INFO] Calcul des indicateurs techniques...
2025-06-17 13:48:34,616 [INFO] Lignes avant nettoyage : 29050
2025-06-17 13:48:34,625 [INFO] Lignes après nettoyage : 28339
2025-06-17 13:48:34,626 [INFO] Création des labels...
2025-06-17 13:48:35,012 [INFO] Sélection des colonnes...
2025-06-17 13:48:35,195 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['rsi_dist_oversold', 'rsi_dist_overbought', 'sma_200', 'ema_20', 'ema_100', 'bb_upper', 'bb_lower', 'macd_signal', 'williams_r', 'kama', 'vwap', 'price_diff_1']
2025-06-17 13:48:36,618 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-17 13:48:58,028 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-17 13:48:58,075 [INFO] Démarrage de l'exécution multi-seeds : [42]
2025-06-17 13:48:58,076 [INFO] --- Début du run avec seed 42 ---
2025-06-17 13:48:58,079 [INFO] Entraînement du modèle principal
2025-06-17 13:50:15,635 [INFO] Évaluation du modèle principal
2025-06-17 13:50:15,976 [INFO] Seed 42 — Accuracy: 0.5051, Precision: 0.5406, Recall: 0.6045, F1: 0.5056
2025-06-17 13:50:15,978 [INFO] Génération du dataset méta
2025-06-17 13:50:15,978 [INFO]  Traitement du seed 42...
2025-06-17 13:50:16,142 [INFO] Seed 42 - X_train shape: (19823, 20, 24)
2025-06-17 13:50:54,756 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 13:50:54,756 [INFO] Fichier sauvegardé : C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 13:50:54,774 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-17 13:51:01,137 [INFO] Entraînement du méta-modèle...
2025-06-17 13:51:11,647 [INFO] Évaluation sur le set de test :
2025-06-17 13:51:11,669 [INFO]               precision    recall  f1-score   support

           0       0.58      0.41      0.48      2502
           1       0.62      0.76      0.68      3162

    accuracy                           0.61      5664
   macro avg       0.60      0.59      0.58      5664
weighted avg       0.60      0.61      0.59      5664

2025-06-17 13:51:11,674 [INFO] ROC AUC Score : 0.587040
2025-06-17 13:51:11,677 [INFO] Confusion Matrix :
[[1029 1473]
 [ 750 2412]]
2025-06-17 13:51:11,688 [INFO] Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-17 13:51:11,727 [INFO] Analyse du capture ratio
2025-06-17 13:51:12,680 [INFO] --- Fin du run avec seed 42 ---

2025-06-17 13:51:12,682 [INFO] Moyenne des scores sur tous les seeds :
2025-06-17 13:51:12,683 [INFO] accuracy            0.5051
precision_macro     0.5406
recall_macro        0.6045
f1_macro            0.5056
seed               42.0000
dtype: float64
2025-06-17 13:51:12,687 [INFO] Écart-type des scores :
2025-06-17 13:51:12,688 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-17 13:51:12,692 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
2025-06-17 14:04:09,072 [INFO] Génération de l'exogenous dataset
2025-06-17 14:04:09,072 [INFO] Téléchargement des données...
2025-06-17 14:04:10,525 [INFO] Calcul des indicateurs techniques...
2025-06-17 14:05:51,592 [INFO] Lignes avant nettoyage : 29050
2025-06-17 14:05:51,604 [INFO] Lignes après nettoyage : 28339
2025-06-17 14:05:51,604 [INFO] Création des labels...
2025-06-17 14:05:52,336 [INFO] Sélection des colonnes...
2025-06-17 14:05:52,539 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['rsi_dist_oversold', 'rsi_dist_overbought', 'sma_200', 'ema_20', 'ema_100', 'bb_upper', 'bb_lower', 'macd_signal', 'williams_r', 'kama', 'vwap', 'price_diff_1']
2025-06-17 14:05:54,155 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-17 14:06:52,447 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-17 14:06:52,504 [INFO] Démarrage de l'exécution multi-seeds : [42]
2025-06-17 14:06:52,505 [INFO] --- Début du run avec seed 42 ---
2025-06-17 14:06:52,620 [INFO] Entraînement du modèle principal
2025-06-17 14:08:47,253 [INFO] Epoch 1/20 - Train Loss: 0.5501 - Val Loss: 0.5459 - Best Val Loss: inf
2025-06-17 14:11:14,084 [DEBUG] This is a DEBUG message
2025-06-17 14:11:14,084 [INFO] This is an INFO message
2025-06-17 14:11:14,084 [WARNING] This is a WARNING message
2025-06-17 14:11:14,084 [ERROR] This is an ERROR message
2025-06-17 14:11:14,084 [CRITICAL] This is a CRITICAL message
2025-06-17 14:11:58,231 [INFO] Génération de l'exogenous dataset
2025-06-17 14:11:58,232 [INFO] Téléchargement des données...
2025-06-17 14:11:59,500 [INFO] Calcul des indicateurs techniques...
2025-06-17 14:12:36,225 [INFO] Lignes avant nettoyage : 29050
2025-06-17 14:12:36,235 [INFO] Lignes après nettoyage : 28339
2025-06-17 14:12:36,235 [INFO] Création des labels...
2025-06-17 14:12:36,631 [INFO] Sélection des colonnes...
2025-06-17 14:12:36,829 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['rsi_dist_oversold', 'rsi_dist_overbought', 'sma_200', 'ema_20', 'ema_100', 'bb_upper', 'bb_lower', 'macd_signal', 'williams_r', 'kama', 'vwap', 'price_diff_1']
2025-06-17 14:12:38,236 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-17 14:13:01,134 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-17 14:13:01,182 [INFO] Démarrage de l'exécution multi-seeds : [42]
2025-06-17 14:13:01,183 [INFO] --- Début du run avec seed 42 ---
2025-06-17 14:13:01,271 [INFO] Entraînement du modèle principal
2025-06-17 14:13:11,545 [DEBUG] Epoch 1/20 - Train Loss: 0.5501 - Val Loss: 0.5459 - Best Val Loss: inf
2025-06-17 14:13:14,779 [DEBUG] Epoch 2/20 - Train Loss: 0.5367 - Val Loss: 0.5345 - Best Val Loss: 0.5459
2025-06-17 14:13:18,111 [DEBUG] Epoch 3/20 - Train Loss: 0.5179 - Val Loss: 0.5214 - Best Val Loss: 0.5345
2025-06-17 14:13:22,037 [DEBUG] Epoch 4/20 - Train Loss: 0.4935 - Val Loss: 0.5122 - Best Val Loss: 0.5214
2025-06-17 14:13:25,348 [DEBUG] Epoch 5/20 - Train Loss: 0.4677 - Val Loss: 0.4961 - Best Val Loss: 0.5122
2025-06-17 14:13:28,717 [DEBUG] Epoch 6/20 - Train Loss: 0.4388 - Val Loss: 0.4942 - Best Val Loss: 0.4961
2025-06-17 14:13:32,254 [DEBUG] Epoch 7/20 - Train Loss: 0.4106 - Val Loss: 0.4849 - Best Val Loss: 0.4942
2025-06-17 14:13:35,553 [DEBUG] Epoch 8/20 - Train Loss: 0.3834 - Val Loss: 0.4692 - Best Val Loss: 0.4849
2025-06-17 14:13:38,730 [DEBUG] Epoch 9/20 - Train Loss: 0.3574 - Val Loss: 0.4720 - Best Val Loss: 0.4692
2025-06-17 14:13:41,865 [DEBUG] Epoch 10/20 - Train Loss: 0.3355 - Val Loss: 0.4716 - Best Val Loss: 0.4692
2025-06-17 14:13:45,108 [DEBUG] Epoch 11/20 - Train Loss: 0.3165 - Val Loss: 0.4601 - Best Val Loss: 0.4692
2025-06-17 14:13:47,995 [DEBUG] Epoch 12/20 - Train Loss: 0.2982 - Val Loss: 0.4564 - Best Val Loss: 0.4601
2025-06-17 14:13:51,020 [DEBUG] Epoch 13/20 - Train Loss: 0.2813 - Val Loss: 0.4659 - Best Val Loss: 0.4564
2025-06-17 14:13:53,964 [DEBUG] Epoch 14/20 - Train Loss: 0.2696 - Val Loss: 0.4557 - Best Val Loss: 0.4564
2025-06-17 14:13:58,159 [DEBUG] Epoch 15/20 - Train Loss: 0.2515 - Val Loss: 0.4574 - Best Val Loss: 0.4557
2025-06-17 14:14:02,695 [DEBUG] Epoch 16/20 - Train Loss: 0.2434 - Val Loss: 0.4624 - Best Val Loss: 0.4557
2025-06-17 14:14:05,742 [DEBUG] Epoch 17/20 - Train Loss: 0.2388 - Val Loss: 0.4663 - Best Val Loss: 0.4557
2025-06-17 14:14:08,593 [DEBUG] Epoch 18/20 - Train Loss: 0.2261 - Val Loss: 0.4494 - Best Val Loss: 0.4557
2025-06-17 14:14:12,768 [DEBUG] Epoch 19/20 - Train Loss: 0.2151 - Val Loss: 0.4521 - Best Val Loss: 0.4494
2025-06-17 14:14:15,792 [DEBUG] Epoch 20/20 - Train Loss: 0.2177 - Val Loss: 0.4571 - Best Val Loss: 0.4494
2025-06-17 14:14:15,829 [INFO] Évaluation du modèle principal
2025-06-17 14:14:16,114 [INFO] Seed 42 — Accuracy: 0.5051, Precision: 0.5406, Recall: 0.6045, F1: 0.5056
2025-06-17 14:14:16,116 [INFO] Génération du dataset méta
2025-06-17 14:14:16,117 [INFO]  Traitement du seed 42...
2025-06-17 14:14:16,287 [INFO] Seed 42 - X_train shape: (19823, 20, 24)
2025-06-17 14:14:54,047 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 14:14:54,047 [INFO] Fichier sauvegardé : C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 14:14:54,064 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-17 14:15:00,836 [INFO] Entraînement du méta-modèle...
2025-06-17 14:15:14,042 [INFO] Évaluation sur le set de test :
2025-06-17 14:15:14,060 [INFO]               precision    recall  f1-score   support

           0       0.58      0.41      0.48      2502
           1       0.62      0.76      0.68      3162

    accuracy                           0.61      5664
   macro avg       0.60      0.59      0.58      5664
weighted avg       0.60      0.61      0.59      5664

2025-06-17 14:15:14,065 [INFO] ROC AUC Score : 0.587040
2025-06-17 14:15:14,067 [INFO] Confusion Matrix :
[[1029 1473]
 [ 750 2412]]
2025-06-17 14:15:14,078 [INFO] Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-17 14:15:14,126 [INFO] Analyse du capture ratio
2025-06-17 14:15:14,905 [INFO] --- Fin du run avec seed 42 ---

2025-06-17 14:15:14,907 [INFO] Moyenne des scores sur tous les seeds :
2025-06-17 14:15:14,908 [INFO] accuracy            0.5051
precision_macro     0.5406
recall_macro        0.6045
f1_macro            0.5056
seed               42.0000
dtype: float64
2025-06-17 14:15:14,912 [INFO] Écart-type des scores :
2025-06-17 14:15:14,913 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-17 14:15:14,917 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
2025-06-17 14:51:16,580 [INFO] Génération de l'exogenous dataset
2025-06-17 14:51:16,580 [INFO] Téléchargement des données...
2025-06-17 14:51:17,772 [INFO] Calcul des indicateurs techniques...
2025-06-17 14:52:02,313 [INFO] Lignes avant nettoyage : 29050
2025-06-17 14:52:02,326 [INFO] Lignes après nettoyage : 28339
2025-06-17 14:52:02,327 [INFO] Création des labels...
2025-06-17 14:52:02,851 [INFO] Sélection des colonnes...
2025-06-17 14:52:03,087 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['rsi_dist_oversold', 'rsi_dist_overbought', 'sma_200', 'ema_20', 'ema_100', 'bb_upper', 'bb_lower', 'macd_signal', 'williams_r', 'kama', 'vwap', 'price_diff_1']
2025-06-17 14:52:05,428 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-17 14:54:09,826 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-17 14:54:11,259 [INFO] Démarrage de l'exécution multi-seeds : [42]
2025-06-17 14:54:11,259 [INFO] --- Début du run avec seed 42 ---
2025-06-17 14:54:11,361 [INFO] Entraînement du modèle principal
2025-06-17 14:54:54,106 [DEBUG] Epoch 1/20 - Train Loss: 0.5495 - Val Loss: 0.5545 - Best Val Loss: inf
2025-06-17 14:55:19,193 [DEBUG] Epoch 2/20 - Train Loss: 0.5362 - Val Loss: 0.5467 - Best Val Loss: 0.5545
2025-06-17 14:55:54,162 [DEBUG] Epoch 3/20 - Train Loss: 0.5191 - Val Loss: 0.5382 - Best Val Loss: 0.5467
2025-06-17 14:56:15,424 [DEBUG] Epoch 4/20 - Train Loss: 0.4967 - Val Loss: 0.5241 - Best Val Loss: 0.5382
2025-06-17 14:56:31,663 [DEBUG] Epoch 5/20 - Train Loss: 0.4727 - Val Loss: 0.5072 - Best Val Loss: 0.5241
2025-06-17 14:56:52,927 [DEBUG] Epoch 6/20 - Train Loss: 0.4414 - Val Loss: 0.4838 - Best Val Loss: 0.5072
2025-06-17 14:57:10,865 [DEBUG] Epoch 7/20 - Train Loss: 0.4132 - Val Loss: 0.4734 - Best Val Loss: 0.4838
2025-06-17 14:57:25,896 [DEBUG] Epoch 8/20 - Train Loss: 0.3852 - Val Loss: 0.4688 - Best Val Loss: 0.4734
2025-06-17 14:57:40,656 [DEBUG] Epoch 9/20 - Train Loss: 0.3654 - Val Loss: 0.4614 - Best Val Loss: 0.4688
2025-06-17 14:57:54,796 [DEBUG] Epoch 10/20 - Train Loss: 0.3462 - Val Loss: 0.4621 - Best Val Loss: 0.4614
2025-06-17 14:58:10,912 [DEBUG] Epoch 11/20 - Train Loss: 0.3372 - Val Loss: 0.4495 - Best Val Loss: 0.4614
2025-06-17 14:58:26,192 [DEBUG] Epoch 12/20 - Train Loss: 0.3276 - Val Loss: 0.4396 - Best Val Loss: 0.4495
2025-06-17 14:58:42,677 [DEBUG] Epoch 13/20 - Train Loss: 0.3080 - Val Loss: 0.4367 - Best Val Loss: 0.4396
2025-06-17 14:59:10,454 [DEBUG] Epoch 14/20 - Train Loss: 0.3047 - Val Loss: 0.4274 - Best Val Loss: 0.4367
2025-06-17 14:59:28,656 [DEBUG] Epoch 15/20 - Train Loss: 0.2886 - Val Loss: 0.4314 - Best Val Loss: 0.4274
2025-06-17 14:59:50,424 [DEBUG] Epoch 16/20 - Train Loss: 0.2723 - Val Loss: 0.4249 - Best Val Loss: 0.4274
2025-06-17 15:00:28,154 [DEBUG] Epoch 17/20 - Train Loss: 0.2731 - Val Loss: 0.4282 - Best Val Loss: 0.4249
2025-06-17 15:00:56,276 [DEBUG] Epoch 18/20 - Train Loss: 0.2577 - Val Loss: 0.4209 - Best Val Loss: 0.4249
2025-06-17 15:01:13,358 [DEBUG] Epoch 19/20 - Train Loss: 0.2573 - Val Loss: 0.4246 - Best Val Loss: 0.4209
2025-06-17 15:01:26,930 [DEBUG] Epoch 20/20 - Train Loss: 0.2467 - Val Loss: 0.4185 - Best Val Loss: 0.4209
2025-06-17 15:01:27,318 [INFO] Évaluation du modèle principal
2025-06-17 15:01:28,349 [INFO] Seed 42 — Accuracy: 0.4631, Precision: 0.5275, Recall: 0.5986, F1: 0.4687
2025-06-17 15:01:28,365 [INFO] Génération du dataset méta
2025-06-17 15:01:28,365 [INFO]  Traitement du seed 42...
2025-06-17 15:01:29,205 [INFO] Seed 42 - X_train shape: (19697, 200, 24)
2025-06-17 15:08:46,174 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 15:08:46,174 [INFO] Fichier sauvegardé : C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-17 15:08:46,416 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-17 15:10:01,334 [INFO] Entraînement du méta-modèle...
2025-06-17 15:11:46,930 [INFO] Évaluation sur le set de test :
2025-06-17 15:11:46,949 [INFO]               precision    recall  f1-score   support

           0       0.62      0.60      0.61      2727
           1       0.64      0.66      0.65      2901

    accuracy                           0.63      5628
   macro avg       0.63      0.63      0.63      5628
weighted avg       0.63      0.63      0.63      5628

2025-06-17 15:11:46,956 [INFO] ROC AUC Score : 0.629718
2025-06-17 15:11:46,961 [INFO] Confusion Matrix :
[[1624 1103]
 [ 975 1926]]
2025-06-17 15:11:46,977 [INFO] Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-17 15:11:47,478 [INFO] Analyse du capture ratio
2025-06-17 15:11:48,456 [INFO] --- Fin du run avec seed 42 ---

2025-06-17 15:11:48,458 [INFO] Moyenne des scores sur tous les seeds :
2025-06-17 15:11:48,460 [INFO] accuracy            0.4631
precision_macro     0.5275
recall_macro        0.5986
f1_macro            0.4687
seed               42.0000
dtype: float64
2025-06-17 15:11:48,464 [INFO] Écart-type des scores :
2025-06-17 15:11:48,465 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-17 15:11:48,471 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
