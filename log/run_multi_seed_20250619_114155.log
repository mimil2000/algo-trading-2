2025-06-19 11:41:55,447 [INFO] Génération de l'exogenous dataset
2025-06-19 11:41:55,449 [INFO] Chargement des données...
2025-06-19 11:41:56,828 [INFO] Application de la différentiation fractionnaire...
2025-06-19 11:42:02,776 [INFO] Calcul des indicateurs techniques...
2025-06-19 11:42:38,050 [INFO] Nettoyage des données...
2025-06-19 11:42:38,060 [INFO] Génération des labels triple barrière...
2025-06-19 11:42:38,439 [DEBUG] Window: 4h - Distribution des labels: {0: 0.7540179887938662, 2: 0.12724859923326454, 1: 0.11873341197286937}
2025-06-19 11:42:38,851 [DEBUG] Window: 8h - Distribution des labels: {0: 0.585446770864052, 2: 0.21029932173400176, 1: 0.20425390740194632}
2025-06-19 11:42:39,306 [DEBUG] Window: 12h - Distribution des labels: {0: 0.48462842819227364, 2: 0.2592524329106458, 1: 0.2561191388970805}
2025-06-19 11:42:39,834 [DEBUG] Window: 24h - Distribution des labels: {0: 0.3741153052196992, 1: 0.3161309348274845, 2: 0.3097537599528163}
2025-06-19 11:42:40,439 [DEBUG] Window: 48h - Distribution des labels: {0: 0.3573429666764966, 1: 0.32483043350044233, 2: 0.31782659982306105}
2025-06-19 11:42:40,439 [INFO] PREDICTION_WINDOW sélectionnée : 24
2025-06-19 11:42:41,191 [INFO] Colonnes supprimées à cause d'une corrélation > 0.95 : ['high', 'low', 'close', 'sma_50', 'sma_200', 'ema_20', 'ema_100', 'rsi_dist_oversold', 'rsi_dist_overbought', 'bb_upper', 'bb_lower', 'macd_signal', 'price_diff_1', 'williams_r', 'kama', 'vwap']
2025-06-19 11:42:42,606 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\features_and_target.csv
2025-06-19 11:42:42,606 [INFO] Construction des séquences...
2025-06-19 11:44:47,102 [INFO] Dataset séquentiel sauvegardé sous C:\CWE_DA\Python\algo-trading-2\exogenous_model\dataset\features_and_target\sequential_dataset.npz avec noms de colonnes
2025-06-19 11:44:48,350 [INFO] Démarrage de l'exécution multi-seeds : [42]
2025-06-19 11:44:48,351 [INFO] 
--- Début du run avec seed 42 ---
2025-06-19 11:44:48,475 [INFO] Entraînement du modèle principal
2025-06-19 11:45:52,702 [DEBUG] Epoch 1/100 - Train Loss: 0.4872 - Val Loss: 0.4833 - Best Val Loss: inf
2025-06-19 11:46:06,227 [DEBUG] Epoch 2/100 - Train Loss: 0.4767 - Val Loss: 0.4759 - Best Val Loss: 0.4833
2025-06-19 11:46:20,558 [DEBUG] Epoch 3/100 - Train Loss: 0.4588 - Val Loss: 0.4599 - Best Val Loss: 0.4759
2025-06-19 11:46:34,427 [DEBUG] Epoch 4/100 - Train Loss: 0.4332 - Val Loss: 0.4436 - Best Val Loss: 0.4599
2025-06-19 11:46:48,046 [DEBUG] Epoch 5/100 - Train Loss: 0.4032 - Val Loss: 0.4165 - Best Val Loss: 0.4436
2025-06-19 11:47:04,508 [DEBUG] Epoch 6/100 - Train Loss: 0.3721 - Val Loss: 0.3978 - Best Val Loss: 0.4165
2025-06-19 11:47:18,289 [DEBUG] Epoch 7/100 - Train Loss: 0.3480 - Val Loss: 0.3789 - Best Val Loss: 0.3978
2025-06-19 11:47:32,157 [DEBUG] Epoch 8/100 - Train Loss: 0.3397 - Val Loss: 0.3760 - Best Val Loss: 0.3789
2025-06-19 11:47:45,629 [DEBUG] Epoch 9/100 - Train Loss: 0.3112 - Val Loss: 0.3552 - Best Val Loss: 0.3760
2025-06-19 11:47:59,106 [DEBUG] Epoch 10/100 - Train Loss: 0.2918 - Val Loss: 0.3498 - Best Val Loss: 0.3552
2025-06-19 11:48:11,788 [DEBUG] Epoch 11/100 - Train Loss: 0.2792 - Val Loss: 0.3433 - Best Val Loss: 0.3498
2025-06-19 11:48:25,098 [DEBUG] Epoch 12/100 - Train Loss: 0.2741 - Val Loss: 0.3484 - Best Val Loss: 0.3433
2025-06-19 11:48:37,986 [DEBUG] Epoch 13/100 - Train Loss: 0.2637 - Val Loss: 0.3348 - Best Val Loss: 0.3433
2025-06-19 11:48:51,192 [DEBUG] Epoch 14/100 - Train Loss: 0.2556 - Val Loss: 0.3257 - Best Val Loss: 0.3348
2025-06-19 11:49:04,625 [DEBUG] Epoch 15/100 - Train Loss: 0.2439 - Val Loss: 0.3466 - Best Val Loss: 0.3257
2025-06-19 11:49:17,726 [DEBUG] Epoch 16/100 - Train Loss: 0.2408 - Val Loss: 0.3248 - Best Val Loss: 0.3257
2025-06-19 11:49:31,147 [DEBUG] Epoch 17/100 - Train Loss: 0.2317 - Val Loss: 0.3310 - Best Val Loss: 0.3248
2025-06-19 11:49:45,021 [DEBUG] Epoch 18/100 - Train Loss: 0.2307 - Val Loss: 0.3223 - Best Val Loss: 0.3248
2025-06-19 11:49:58,711 [DEBUG] Epoch 19/100 - Train Loss: 0.2191 - Val Loss: 0.3218 - Best Val Loss: 0.3223
2025-06-19 11:50:13,046 [DEBUG] Epoch 20/100 - Train Loss: 0.2203 - Val Loss: 0.3265 - Best Val Loss: 0.3218
2025-06-19 11:50:26,289 [DEBUG] Epoch 21/100 - Train Loss: 0.2147 - Val Loss: 0.3179 - Best Val Loss: 0.3218
2025-06-19 11:50:39,326 [DEBUG] Epoch 22/100 - Train Loss: 0.2096 - Val Loss: 0.3183 - Best Val Loss: 0.3179
2025-06-19 11:50:52,653 [DEBUG] Epoch 23/100 - Train Loss: 0.2057 - Val Loss: 0.3126 - Best Val Loss: 0.3179
2025-06-19 11:51:06,203 [DEBUG] Epoch 24/100 - Train Loss: 0.2010 - Val Loss: 0.3187 - Best Val Loss: 0.3126
2025-06-19 11:51:19,286 [DEBUG] Epoch 25/100 - Train Loss: 0.1941 - Val Loss: 0.3175 - Best Val Loss: 0.3126
2025-06-19 11:51:32,396 [DEBUG] Epoch 26/100 - Train Loss: 0.1917 - Val Loss: 0.3225 - Best Val Loss: 0.3126
2025-06-19 11:51:44,858 [DEBUG] Epoch 27/100 - Train Loss: 0.2061 - Val Loss: 0.3185 - Best Val Loss: 0.3126
2025-06-19 11:51:57,767 [DEBUG] Epoch 28/100 - Train Loss: 0.1888 - Val Loss: 0.3205 - Best Val Loss: 0.3126
2025-06-19 11:52:11,015 [DEBUG] Epoch 29/100 - Train Loss: 0.1869 - Val Loss: 0.3173 - Best Val Loss: 0.3126
2025-06-19 11:52:24,591 [DEBUG] Epoch 30/100 - Train Loss: 0.1768 - Val Loss: 0.3197 - Best Val Loss: 0.3126
2025-06-19 11:52:37,700 [DEBUG] Epoch 31/100 - Train Loss: 0.1822 - Val Loss: 0.3216 - Best Val Loss: 0.3126
2025-06-19 11:52:50,783 [DEBUG] Epoch 32/100 - Train Loss: 0.1742 - Val Loss: 0.3243 - Best Val Loss: 0.3126
2025-06-19 11:53:04,782 [DEBUG] Epoch 33/100 - Train Loss: 0.1716 - Val Loss: 0.3287 - Best Val Loss: 0.3126
2025-06-19 11:53:04,783 [INFO] Early stopping at epoch 33
2025-06-19 11:53:05,075 [INFO] Évaluation du modèle principal
2025-06-19 11:53:06,080 [INFO] Accuracy: 0.6416, Precision: 0.6423, Recall: 0.6519, F1: 0.6450
2025-06-19 11:53:06,098 [INFO] Génération du dataset méta
2025-06-19 11:53:07,032 [INFO] Prédiction du modèle principal ...
2025-06-19 11:53:12,782 [INFO] Méta labels créés
2025-06-19 12:00:19,986 [INFO] Dataset sauvegardé sous C:\CWE_DA\Python\algo-trading-2\meta_model\dataset\features_and_target\meta_dataset_seed_42.csv
2025-06-19 12:00:20,201 [INFO] Entraînement et évaluation du modèle XGBoost méta
2025-06-19 12:01:40,498 [INFO] Entraînement du méta-modèle...
2025-06-19 12:03:26,586 [INFO] Évaluation sur le set de test :
2025-06-19 12:03:26,606 [INFO]               precision    recall  f1-score   support

           0       0.44      0.06      0.11      1565
           1       0.72      0.97      0.82      3821

    accuracy                           0.70      5386
   macro avg       0.58      0.51      0.47      5386
weighted avg       0.64      0.70      0.62      5386

2025-06-19 12:03:26,612 [INFO] ROC AUC Score : 0.514968
2025-06-19 12:03:26,616 [INFO] Confusion Matrix :
[[  96 1469]
 [ 120 3701]]
2025-06-19 12:03:26,637 [INFO] Modèle sauvegardé : xgboost_meta_model.joblib
2025-06-19 12:03:27,679 [INFO] Analyse du capture ratio
2025-06-19 12:03:28,910 [INFO] --- Fin du run avec seed 42 ---

2025-06-19 12:03:28,912 [INFO] Moyenne des scores sur tous les seeds :
2025-06-19 12:03:28,914 [INFO] accuracy            0.6416
precision_macro     0.6423
recall_macro        0.6519
f1_macro            0.6450
seed               42.0000
dtype: float64
2025-06-19 12:03:28,917 [INFO] Écart-type des scores :
2025-06-19 12:03:28,921 [INFO] accuracy          NaN
precision_macro   NaN
recall_macro      NaN
f1_macro          NaN
seed              NaN
dtype: float64
2025-06-19 12:03:28,925 [INFO] Résultats enregistrés dans meta_model/results/results_multi_seed.csv
